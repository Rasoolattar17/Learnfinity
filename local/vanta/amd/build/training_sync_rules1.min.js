define("local_vanta/training_sync_rules1",["jquery","core/str","core/ajax","core/notification","core/templates","core/st_loader","core/url","select2-js"],(function($,str,ajax,notification,templates,stLoader){var trainingSyncRules={dom:{main:null,frameworksSelect:null,coursesSelect:null,completionModeContainer:null,completionModeSelect:null,saveButton:null,form:null,resourceId:null},lang:{somethingWentWrong:null,saveSuccess:null},variables:{vantaId:0,selectedFrameworks:[],selectedCourses:[]},action:{getStringValues:function(){str.get_strings([{key:"some_thing_went_wrong",component:"local_vanta"},{key:"settingssaved",component:"local_vanta"}]).done((function(langstrs){trainingSyncRules.lang.somethingWentWrong=langstrs[0],trainingSyncRules.lang.saveSuccess=langstrs[1],trainingSyncRules.init()})).fail((function(){notification.addNotification({type:"error",message:"Failed to load language strings"})}))},validation:function(){console.log("Running validation...");var isValid=!0;return trainingSyncRules.dom.resourceId&&""!==trainingSyncRules.dom.resourceId.val()?trainingSyncRules.dom.resourceId&&trainingSyncRules.dom.resourceId.removeClass("is-invalid"):(console.log("Resource ID validation failed"),trainingSyncRules.dom.resourceId&&trainingSyncRules.dom.resourceId.addClass("is-invalid"),isValid=!1),0===trainingSyncRules.variables.selectedFrameworks.length?(console.log("Frameworks validation failed"),trainingSyncRules.dom.frameworksSelect&&trainingSyncRules.dom.frameworksSelect.addClass("is-invalid"),isValid=!1):trainingSyncRules.dom.frameworksSelect&&trainingSyncRules.dom.frameworksSelect.removeClass("is-invalid"),0===trainingSyncRules.variables.selectedCourses.length?(console.log("Courses validation failed"),trainingSyncRules.dom.coursesSelect&&trainingSyncRules.dom.coursesSelect.addClass("is-invalid"),isValid=!1):trainingSyncRules.dom.coursesSelect&&trainingSyncRules.dom.coursesSelect.removeClass("is-invalid"),console.log("Validation result:",isValid),isValid},saveSettings:function(){console.log("Starting save settings..."),stLoader.showLoader();var formData={frameworks:trainingSyncRules.variables.selectedFrameworks,courses:trainingSyncRules.variables.selectedCourses,completionmode:trainingSyncRules.dom.completionModeSelect.val(),resourceid:trainingSyncRules.dom.resourceId.val()};console.log("Form data:",formData),ajax.call([{methodname:"local_vanta_save_sync_rules",args:formData}])[0].done((function(response){stLoader.hideLoader(),console.log("Save response:",response),response.success?notification.addNotification({type:"success",message:trainingSyncRules.lang.saveSuccess}):notification.addNotification({type:"error",message:response.message||trainingSyncRules.lang.somethingWentWrong})})).fail((function(error){stLoader.hideLoader(),console.error("Save failed:",error),notification.addNotification({type:"error",message:trainingSyncRules.lang.somethingWentWrong})}))}},init:function(){if(console.log("Initializing training sync rules..."),trainingSyncRules.dom.main=$("#local_vanta_training_sync_rules"),trainingSyncRules.dom.form=$("#vanta-sync-rules-form"),trainingSyncRules.dom.frameworksSelect=$("#frameworks"),trainingSyncRules.dom.coursesSelect=$("#courses"),trainingSyncRules.dom.resourceId=$(".resource_id"),trainingSyncRules.dom.completionModeContainer=$("#completion_mode_container"),trainingSyncRules.dom.completionModeSelect=$("#completion_mode"),trainingSyncRules.dom.saveButton=$(".save-sync-rules"),trainingSyncRules.dom.saveButton.on("click",(function(e){console.log("Save button clicked"),e.preventDefault(),e.stopPropagation(),trainingSyncRules.variables.selectedFrameworks=trainingSyncRules.dom.frameworksSelect.val()||[],trainingSyncRules.variables.selectedCourses=trainingSyncRules.dom.coursesSelect.val()||[],trainingSyncRules.action.validation()&&trainingSyncRules.action.saveSettings()})),console.log("DOM elements found:"),console.log("- Main container:",trainingSyncRules.dom.main.length),console.log("- Form:",trainingSyncRules.dom.form.length),console.log("- Frameworks select:",trainingSyncRules.dom.frameworksSelect.length),console.log("- Courses select:",trainingSyncRules.dom.coursesSelect.length),console.log("- Resource ID:",trainingSyncRules.dom.resourceId.length),console.log("- Save button:",trainingSyncRules.dom.saveButton.length),trainingSyncRules.variables.selectedFrameworks=trainingSyncRules.dom.frameworksSelect.val()||[],trainingSyncRules.variables.selectedCourses=trainingSyncRules.dom.coursesSelect.val()||[],trainingSyncRules.variables.selectedCourses.length>1?(trainingSyncRules.dom.completionModeContainer.show(),trainingSyncRules.dom.completionModeSelect.val()||trainingSyncRules.dom.completionModeSelect.val("any")):(trainingSyncRules.dom.completionModeContainer.hide(),trainingSyncRules.dom.completionModeSelect.val("any")),trainingSyncRules.dom.frameworksSelect.length>0)try{trainingSyncRules.dom.frameworksSelect.select2({placeholder:"Select compliance frameworks",allowClear:!0,width:"100%"})}catch(e){console.error("Error initializing frameworks select2:",e)}if(trainingSyncRules.dom.coursesSelect.length>0)try{trainingSyncRules.dom.coursesSelect.select2({placeholder:"Select courses",allowClear:!0,width:"100%"})}catch(e){console.error("Error initializing courses select2:",e)}trainingSyncRules.dom.coursesSelect.on("change",(function(){console.log("Course selection changed");var selectedCourses=$(this).val();trainingSyncRules.variables.selectedCourses=selectedCourses||[],selectedCourses&&selectedCourses.length>1?(trainingSyncRules.dom.completionModeContainer.show(),trainingSyncRules.dom.completionModeSelect.val()||trainingSyncRules.dom.completionModeSelect.val("any")):(trainingSyncRules.dom.completionModeContainer.hide(),trainingSyncRules.dom.completionModeSelect.val("any"))})),trainingSyncRules.dom.frameworksSelect.on("change",(function(){trainingSyncRules.variables.selectedFrameworks=$(this).val()||[]})),trainingSyncRules.dom.form.length>0&&trainingSyncRules.dom.form.on("submit",(function(e){return console.log("Form submit prevented"),e.preventDefault(),!1})),console.log("Training sync rules initialization complete")}};return{init:trainingSyncRules.action.getStringValues}}));

//# sourceMappingURL=training_sync_rules1.min.js.map