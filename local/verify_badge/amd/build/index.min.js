define("local_verify_badge/index",["jquery","core/str","core/notification","core/ajax","core/url"],(function($,str,notification,ajax,moodleurl){var verifyBadge={dom:{main:null,extraContent:null,title:null,badgeText:null,badgeLink:null,badgeDescription:null,issueOrg:null,orgLink:null,tags:null,skills:null,badgeImage:null,submit:null,previewphoto:null,removeicon:null,badgeImageContainer:null},langs:{somethingwentwrong:null,badgeadded:null,message1:null,message2:null,yes:null,no:null,validate:null},variables:{courseid:null,imageexists:null,extraContent:null,badgeImage:null},url:{back:function(courseid){return moodleurl.relativeUrl("/local/develop/courseblocks.php?id="+courseid)}},action:{getstringvalues:function(courseid,imageexists){verifyBadge.variables.courseid=courseid,verifyBadge.variables.imageexists=imageexists,str.get_strings([{key:"somethingwentwrong",component:"local_verify_badge"},{key:"badge_added",component:"local_verify_badge"},{key:"message1",component:"local_verify_badge"},{key:"message2",component:"local_verify_badge"},{key:"yes"},{key:"no"},{key:"validate",component:"local_verify_badge"}]).done((function(langstrstring){verifyBadge.langs.somethingwentwrong=langstrstring[0],verifyBadge.langs.badgeadded=langstrstring[1],verifyBadge.langs.message1=langstrstring[2],verifyBadge.langs.message2=langstrstring[3],verifyBadge.langs.yes=langstrstring[4],verifyBadge.langs.no=langstrstring[5],verifyBadge.langs.validate=langstrstring[6],verifyBadge.init()})).fail((function(){notification.addNotification({type:"error",message:"Something went wrong.."})}))},addBadgeDetails:function(){var wysiwygContent=$("#cke_cke-editor-extra-content .cke_wysiwyg_frame.cke_reset").contents().find("body").html();wysiwygContent&&""!==wysiwygContent.trim()?verifyBadge.variables.extraContent=wysiwygContent:verifyBadge.variables.extraContent=$("textarea.cke_source").val(),ajax.call([{methodname:"local_verfiy_badge_add_badge_details",args:{courseid:verifyBadge.variables.courseid,title:verifyBadge.dom.title.val(),badgetext:verifyBadge.dom.badgeText.val(),badgelink:verifyBadge.dom.badgeLink.val(),badgedescription:verifyBadge.dom.badgeDescription.val(),issueorg:verifyBadge.dom.issueOrg.val(),orglink:verifyBadge.dom.orgLink.val(),tags:verifyBadge.dom.tags.val(),skills:verifyBadge.dom.skills.val(),extracontent:verifyBadge.variables.extraContent,badgeimage:verifyBadge.dom.badgeImage.val()}}])[0].done((function(){$("#page").animate({scrollTop:0},"slow"),notification.addNotification({type:"success",message:verifyBadge.langs.badgeadded}),verifyBadge.action.imageupload()})).fail((function(){notification.addNotification({type:"error",message:verifyBadge.langs.somethingwentwrong})}))},validation:function(){var imagedot=verifyBadge.dom.badgeImage.val().split("."),Extension=verifyBadge.dom.badgeImage.val().split(".").pop();if(!1===verifyBadge.variables.imageexists&&""==verifyBadge.dom.badgeImage.val().trim())return verifyBadge.dom.badgeImage.addClass("is-invalid"),verifyBadge.dom.badgeImage.parent().find(".invalid-feedback").html(verifyBadge.langs.validate),$("html, body").animate({scrollTop:verifyBadge.dom.badgeImage.offset().top-100},500),!1;if(""!==verifyBadge.dom.badgeImage.val().trim()){if(imagedot.length>2)return verifyBadge.dom.badgeImage.addClass("is-invalid"),verifyBadge.dom.badgeImage.parent().find(".invalid-feedback").html(verifyBadge.langs.dotimage),$("html, body").animate({scrollTop:verifyBadge.dom.badgeImage.offset().top-100},500),!1;if(-1==$.inArray(Extension,["jpeg","png","jpg"]))return verifyBadge.dom.badgeImage.addClass("is-invalid"),verifyBadge.dom.badgeImage.parent().find(".invalid-feedback").html(verifyBadge.langs.extension),$("html, body").animate({scrollTop:verifyBadge.dom.badgeImage.offset().top-100},500),!1;verifyBadge.dom.badgeImage.removeClass("is-invalid")}else verifyBadge.dom.badgeImage.removeClass("is-invalid");return""==verifyBadge.dom.title.val().trim()?(verifyBadge.dom.title.addClass("is-invalid"),$("html, body").animate({scrollTop:verifyBadge.dom.title.offset().top-100},500),!1):(verifyBadge.dom.title.removeClass("is-invalid"),""==verifyBadge.dom.badgeText.val().trim()?(verifyBadge.dom.badgeText.addClass("is-invalid"),$("html, body").animate({scrollTop:verifyBadge.dom.badgeText.offset().top-100},500),!1):(verifyBadge.dom.badgeText.removeClass("is-invalid"),""==verifyBadge.dom.badgeLink.val().trim()?(verifyBadge.dom.badgeLink.addClass("is-invalid"),$("html, body").animate({scrollTop:verifyBadge.dom.badgeLink.offset().top-100},500),!1):(verifyBadge.dom.badgeLink.removeClass("is-invalid"),""==verifyBadge.dom.badgeDescription.val()?(verifyBadge.dom.badgeDescription.addClass("is-invalid"),$("html, body").animate({scrollTop:verifyBadge.dom.badgeDescription.offset().top-100},500),!1):(verifyBadge.dom.badgeDescription.removeClass("is-invalid"),""==verifyBadge.dom.issueOrg.val().trim()?(verifyBadge.dom.issueOrg.addClass("is-invalid"),!1):(verifyBadge.dom.issueOrg.removeClass("is-invalid"),""==verifyBadge.dom.orgLink.val().trim()?(verifyBadge.dom.orgLink.addClass("is-invalid"),!1):(verifyBadge.dom.orgLink.removeClass("is-invalid"),""==verifyBadge.dom.tags.val().trim()?(verifyBadge.dom.tags.addClass("is-invalid"),!1):(verifyBadge.dom.tags.removeClass("is-invalid"),""==verifyBadge.dom.skills.val().trim()?(verifyBadge.dom.skills.addClass("is-invalid"),!1):(verifyBadge.dom.skills.removeClass("is-invalid"),!0))))))))},getImage:function(event){verifyBadge.dom.previewphoto.attr("src",URL.createObjectURL(event.target.files[0])),verifyBadge.dom.removeicon.removeClass("d-none"),verifyBadge.dom.badgeImageContainer.removeClass("d-none")},removePhoto:function(){verifyBadge.dom.previewphoto.attr("src",""),verifyBadge.dom.removeicon.addClass("d-none"),verifyBadge.dom.badgeImageContainer.addClass("d-none")},imageupload:function(){var data=new FormData($(".verifybadge")[0]);data.append("courseid",verifyBadge.variables.courseid),data.append("badge-logo",verifyBadge.dom.badgeImage.val()),$.ajax({url:moodleurl.relativeUrl("/local/verify_badge/ajax/image_upload.php"),type:"POST",data:data,processData:!1,contentType:!1,success:function(){setTimeout((function(){window.location=verifyBadge.url.back(verifyBadge.variables.courseid)}),2e3)},error:function(){notification.addNotification({message:verifyBadge.langs.somethingwentwrong,type:"error"})}})},reallywanttodelete:function(){notification.confirm(verifyBadge.langs.message1,verifyBadge.langs.message2,verifyBadge.langs.yes,verifyBadge.langs.no,(function(){verifyBadge.action.deleteimage()}))},deleteimage:function(){ajax.call([{methodname:"local_verify_badge_delete_image",args:{courseid:verifyBadge.variables.courseid}}])[0].done((function(){verifyBadge.variables.imageexists=!1,notification.addNotification({message:verifyBadge.langs.deleted,type:"success"}),verifyBadge.action.removePhoto()})).fail((function(){notification.addNotification({message:verifyBadge.langs.somethingwentwrong,type:"error"})}))}},init:function(){verifyBadge.dom.main=$(document).find("#local_verify_badge_index"),verifyBadge.dom.title=verifyBadge.dom.main.find(".title"),verifyBadge.dom.badgeText=verifyBadge.dom.main.find(".badge-text"),verifyBadge.dom.badgeLink=verifyBadge.dom.main.find(".badge-link"),verifyBadge.dom.badgeDescription=verifyBadge.dom.main.find(".badge-description"),verifyBadge.dom.issueOrg=verifyBadge.dom.main.find(".issueorg"),verifyBadge.dom.orgLink=verifyBadge.dom.main.find(".org-link"),verifyBadge.dom.tags=verifyBadge.dom.main.find(".tags"),verifyBadge.dom.skills=verifyBadge.dom.main.find(".skills"),verifyBadge.dom.extraContent=verifyBadge.dom.main.find(".extra-content"),verifyBadge.dom.badgeImage=verifyBadge.dom.main.find(".badge-logo"),verifyBadge.dom.badgeImageContainer=verifyBadge.dom.main.find(".badge-image-container"),verifyBadge.dom.previewphoto=verifyBadge.dom.main.find(".badge-preview-photo"),verifyBadge.dom.removeicon=verifyBadge.dom.main.find(".badge-remove-icon"),verifyBadge.dom.submit=verifyBadge.dom.main.find(".submitbtn"),verifyBadge.dom.deleteimage=verifyBadge.dom.main.find(".delete"),verifyBadge.dom.submit.on("click",(function(e){e.preventDefault(),verifyBadge.action.validation()&&verifyBadge.action.addBadgeDetails()})),verifyBadge.dom.badgeImage.change((function(event){verifyBadge.action.getImage(event)})),verifyBadge.dom.deleteimage.click((function(){verifyBadge.action.reallywanttodelete()}))}};return{init:verifyBadge.action.getstringvalues}}));

//# sourceMappingURL=index.min.js.map